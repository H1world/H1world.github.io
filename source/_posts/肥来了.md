---
title: react常见问题汇总。
date: 2018-11-27 16:55:38
categories: 随笔
tags: [react,前端]
---
### mobx使用
因为最先接触的是reactNative，所以就跟之前一样 使用mobx来作为数据管理工具。需要注意的是mobx5需要浏览器支持`proxy`才可以使用，对于不支持`proxy`的浏览器是无法获取mobx状态的。[mobx官网](https://cn.mobx.js.org/)
安装`npm install mobx --save`，React 绑定库: `npm install mobx-react --save`,
package.json:
```json
"mobx": "^4.3.1",
"mobx-react": "^5.0.0",
```
具体使用时可以分开管理使用，栗子：
```
Mobx
│   AppState.js
│   devState.js    
│   getAndSet.js    
│
index.js（入口文件）
```
```jsx
// devState
import { observable } from "mobx";
class DevStore {
  @observable devApi = 'http://dev.com'
}
const devStore = new DevStore();
export default devStore;
---
// AppState
import devStore from "./devState";
let apiStore = { };
if (process.env.REACT_APP_SECRET_API === "dev"){ //环境变量
  apiStore = devStore;
}
const store = { apiStore };
export default store;
---
// index.js
import React from 'react';
import ReactDOM from 'react-dom';
import { Provider } from 'mobx-react';
import AppState from './Mobx/AppState';
import AppRouter from './router/routers';
import registerServiceWorker from './registerServiceWorker';
ReactDOM.render(
  <Provider {...AppState}>
      <AppRouter />
  </Provider>,
  document.getElementById('root'));
registerServiceWorker();
```
```js
import { observable } from "mobx";
class DevStore {
  @observable demoString = '嘻嘻'
}
const devStore = new DevStore();
export default devStore
```
###读取、写入状态
栗子：
```jsx
//getAndSet
import { action, computed, observable } from "mobx";
class HomeStore {
  @observable num = 0;
  @action
  setNum(info) {
    this.num = info
  }
  @computed
  get getNum() {
    return this.num
  }
}
const homeStore = new HomeStore(); 
export default homeStore;
---
//组件内运用 demo.js
import { inject, observer } from "mobx-react";
@inject('HomeStore')
@observer
class Demo extends Component {
  addNum = () =>{
    this.props.HomeStore.num++;
  };
  reduceNum = () => {
    this.props.HomeStore.num--;
  };
  render{
    return(
      <div>
        <div className="demo">
            {this.state.beforNum}
            <br/>
            {this.props.HomeStore.num}
        </div>
        <button onClick={this.addNum} type="button">
          增加
        </button>
        <button onClick={this.reduceNum} type="button">
          减少
        </button>
      </div>
    )
  }
}
```
>这只是简单的应用，具体参考mobx官网文档。
### router v4这个坑货。
>待续